<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>拉萨深度游：全景艺术地图</title>
    <link href="https://cdn.bootcdn.net/ajax/libs/leaflet/1.9.4/leaflet.min.css" rel="stylesheet">
    <style>
        :root {
            --bg-color: #fdfbf0;
            --sidebar-bg: #fdfbf0;
            --text-primary: #3e2723;
            --text-secondary: #5d4037;
            --accent-color: #8B4513;
            --highlight-color: #cc3300;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: "Kaiti SC", "STKaiti", "楷体", serif;
            display: flex;
            height: 100vh;
            background-color: var(--bg-color);
            overflow: hidden;
            color: var(--text-primary);
        }

        #map {
            flex: 7;
            height: 100%;
            border-right: 1px solid rgba(139, 69, 19, 0.2);
            background-color: #f0e6d2;
            z-index: 1;
        }

        /* Map Filter: Vintage Warm Tone */
        .leaflet-tile-pane {
            filter: sepia(0.3) contrast(0.95) brightness(1.02) hue-rotate(-5deg);
        }

        #sidebar {
            flex: 3;
            padding: 40px;
            box-shadow: -5px 0 30px rgba(60, 40, 10, 0.08);
            overflow-y: auto;
            background-image: linear-gradient(var(--sidebar-bg) 0%, var(--sidebar-bg) 100%), linear-gradient(#e8e0c8 1px, transparent 1px);
            background-size: 100% 100%, 100% 30px;
            background-blend-mode: normal, multiply;
            z-index: 2;
            display: flex;
            flex-direction: column;
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            margin-bottom: 30px;
            text-decoration: none;
            color: var(--text-secondary);
            font-size: 14px;
            opacity: 0.7;
            transition: opacity 0.3s;
        }

        .back-link:hover {
            opacity: 1;
        }

        h1 {
            color: #8B0000;
            margin: 0 0 20px 0;
            letter-spacing: 4px;
            font-size: 32px;
            font-weight: normal;
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 15px;
            display: inline-block;
        }

        h2 {
            color: var(--text-secondary);
            font-size: 20px;
            margin-top: 0;
            margin-bottom: 15px;
            font-weight: bold;
        }

        p {
            line-height: 1.8;
            font-size: 16px;
            margin-bottom: 20px;
            text-align: justify;
        }

        .tip {
            background: rgba(139, 69, 19, 0.05);
            padding: 20px;
            border-radius: 2px;
            font-size: 14px;
            margin-bottom: 30px;
            color: var(--text-secondary);
            border-left: 3px solid var(--accent-color);
            font-style: italic;
        }

        .hand-drawn-marker {
            background-color: var(--highlight-color);
            width: 14px;
            height: 14px;
            border-radius: 50%;
            border: 2px solid #fff;
            box-shadow: 0 0 0 2px var(--highlight-color), 2px 2px 4px rgba(0, 0, 0, 0.2);
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .leaflet-marker-icon:hover .hand-drawn-marker {
            transform: scale(1.5);
            background-color: #ff4400;
            box-shadow: 0 0 0 4px rgba(255, 68, 0, 0.3), 4px 4px 8px rgba(0, 0, 0, 0.3);
        }

        .image-frame {
            width: 100%;
            height: 240px;
            overflow: hidden;
            border-radius: 4px;
            border: 8px solid #fff;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            margin-bottom: 25px;
            background-color: #f5f5f5;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: transform 0.3s ease;
        }
        
        .image-frame:hover {
            transform: translateY(-2px);
        }

        svg {
            width: 100%;
            height: 100%;
            transition: transform 1.5s ease;
        }

        .image-frame:hover svg {
            transform: scale(1.08);
        }
        
        #content {
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .meta-info {
            margin-top: auto;
            padding-top: 30px;
            border-top: 1px dashed rgba(139, 69, 19, 0.3);
            font-size: 13px;
            color: #888;
        }

        @media (max-width: 768px) {
            body {
                flex-direction: column;
            }

            #map {
                height: 50vh;
                flex: none;
                border-right: none;
                border-bottom: 1px solid rgba(139, 69, 19, 0.2);
            }

            #sidebar {
                height: 50vh;
                flex: none;
                padding: 25px;
            }
        }
    </style>
</head>

<body>
    <div id="map"></div>
    <div id="sidebar">
        <div>
            <a href="index.html" class="back-link">
                <span style="margin-right: 8px;">←</span> 返回画廊
            </a>
            <h1>拉萨 · 寻隐</h1>
            <div class="tip">
                “在拉萨，每一座寺庙都是时间的琥珀，封存着千年的信仰与故事。”
            </div>
        </div>
        
        <div id="content">
            <h2>准备出发</h2>
            <p>这是一张为您定制的专属艺术地图。</p>
            <p>除了布达拉宫等经典地标，我们还为您标注了<b>哲蚌寺、扎基寺、帕崩岗</b>等深度游秘境。</p>
            <p>点击地图上的红点，聆听拉萨的低语。</p>
        </div>

        <div class="meta-info">
            <p><b>设计理念：</b> 泛黄羊皮卷风格，Sepia 滤镜底图，手绘 SVG 图标。</p>
            <p><b>技术实现：</b> Leaflet.js + 原生 SVG。</p>
        </div>
    </div>
    
    <script src="https://cdn.bootcdn.net/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
    <script>
        const map = L.map('map', { zoomControl: false, attributionControl: false }).setView([29.6525, 91.1250], 13);
        L.control.zoom({ position: 'bottomright' }).addTo(map);
        
        // CartoDB Voyager - nice clean map style
        L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
            subdomains: 'abcd',
            maxZoom: 19
        }).addTo(map);

        const handDrawnIcon = L.divIcon({ 
            className: 'custom-div-icon', 
            html: "<div class='hand-drawn-marker'></div>", 
            iconSize: [18, 18], 
            iconAnchor: [9, 9] 
        });

        // SVG Templates
        const svgs = {
            potala: `<svg viewBox="0 0 400 300"><defs><linearGradient id="sky" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#87CEEB"/><stop offset="100%" stop-color="#E0F7FA"/></linearGradient></defs><rect width="400" height="300" fill="url(#sky)"/><path d="M0,300 L400,300 L400,250 Q200,150 0,250 Z" fill="#8D6E63"/><rect x="50" y="150" width="300" height="100" fill="#F5F5F5"/><rect x="150" y="120" width="100" height="130" fill="#B71C1C"/><rect x="160" y="110" width="80" height="10" fill="#FFD700"/></svg>`,
            jokhang: `<svg viewBox="0 0 400 300"><rect width="400" height="300" fill="#FFF8E1"/><rect x="50" y="150" width="300" height="100" fill="#5D4037"/><path d="M50,150 L100,100 L300,100 L350,150 Z" fill="#FFC107"/><circle cx="200" cy="80" r="30" fill="#FFD700" opacity="0.8"/><circle cx="100" cy="250" r="40" fill="#BDBDBD" opacity="0.5" filter="blur(10px)"/></svg>`,
            barkhor: `<svg viewBox="0 0 400 300"><rect width="400" height="300" fill="#ECEFF1"/><rect x="20" y="100" width="100" height="200" fill="#FFF"/><rect x="280" y="100" width="100" height="200" fill="#FFF"/><path d="M20,100 Q200,180 380,100" stroke="#333" fill="none"/><path d="M50,115 L70,115 L60,135 Z" fill="blue"/><path d="M130,132 L150,132 L140,152 Z" fill="red"/><path d="M210,135 L230,135 L220,155 Z" fill="yellow"/></svg>`,
            norbulingka: `<svg viewBox="0 0 400 300"><rect width="400" height="300" fill="#E8F5E9"/><circle cx="100" cy="200" r="60" fill="#4CAF50"/><circle cx="300" cy="200" r="70" fill="#388E3C"/><rect x="150" y="150" width="100" height="100" fill="#FFD54F"/><rect x="160" y="170" width="80" height="80" fill="#795548"/></svg>`,
            sera: `<svg viewBox="0 0 400 300"><rect width="400" height="300" fill="#D7CCC8"/><path d="M0,0 L400,0 L400,100 Q200,150 0,100 Z" fill="#33691E" opacity="0.8"/><circle cx="150" cy="200" r="40" fill="#B71C1C"/><circle cx="250" cy="220" r="45" fill="#B71C1C"/><path d="M260,180 L280,160" stroke="#B71C1C" stroke-width="5"/></svg>`,
            yaowang: `<svg viewBox="0 0 400 300"><rect width="400" height="300" fill="#CFD8DC"/><circle cx="300" cy="100" r="40" fill="#FF5722"/><path d="M0,300 L150,150 L300,300 Z" fill="#607D8B"/><path d="M200,300 L350,180 L400,300 Z" fill="#546E7A"/></svg>`,
            ramoche: `<svg viewBox="0 0 400 300"><rect width="400" height="300" fill="#FFFDE7"/><path d="M50,200 L350,200 L320,150 L80,150 Z" fill="#A1887F"/> <path d="M100,150 L300,150 L250,100 L150,100 Z" fill="#FFD700"/> <rect x="120" y="200" width="160" height="80" fill="#8D6E63"/> <rect x="180" y="220" width="40" height="60" fill="#3E2723"/> </svg>`,
            drepung: `<svg viewBox="0 0 400 300"><defs><linearGradient id="mountain" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#8D6E63"/><stop offset="100%" stop-color="#5D4037"/></linearGradient></defs><rect width="400" height="300" fill="#E0F2F1"/><path d="M0,300 L400,300 L400,100 L0,200 Z" fill="url(#mountain)"/><rect x="50" y="180" width="60" height="40" fill="#FFF" stroke="#ccc"/><rect x="100" y="160" width="70" height="50" fill="#FFF" stroke="#ccc"/><rect x="160" y="140" width="80" height="60" fill="#FFF" stroke="#ccc"/><rect x="230" y="120" width="90" height="70" fill="#FFF" stroke="#ccc"/></svg>`,
            zaki: `<svg viewBox="0 0 400 300"><rect width="400" height="300" fill="#FFF3E0"/><circle cx="200" cy="150" r="100" fill="#FFD700" opacity="0.2"/><path d="M170,220 Q160,180 180,160 L220,160 Q240,180 230,220 Z" fill="#795548"/><rect x="180" y="150" width="40" height="10" fill="#D7CCC8"/> <text x="190" y="200" fill="#FFD700" font-size="24">￥</text></svg>`,
            canggu: `<svg viewBox="0 0 400 300"><rect width="400" height="300" fill="#FFFDE7"/><rect x="50" y="100" width="300" height="150" fill="#FDD835"/> <circle cx="100" cy="250" r="20" fill="#E91E63" opacity="0.8"/><circle cx="150" cy="260" r="25" fill="#4CAF50" opacity="0.8"/><circle cx="300" cy="250" r="20" fill="#E91E63" opacity="0.8"/><path d="M200,200 L200,150" stroke="#8D6E63" stroke-width="5"/> <circle cx="200" cy="140" r="40" fill="#81C784"/> </svg>`,
            muru: `<svg viewBox="0 0 400 300"><rect width="400" height="300" fill="#ECEFF1"/><rect x="80" y="80" width="240" height="180" fill="#5D4037"/> <rect x="120" y="120" width="160" height="20" fill="#FFCC80"/> <rect x="120" y="160" width="160" height="20" fill="#FFCC80"/><rect x="120" y="200" width="160" height="20" fill="#FFCC80"/></svg>`,
            pabonka: `<svg viewBox="0 0 400 300"><rect width="400" height="300" fill="#E3F2FD"/><path d="M100,300 Q150,150 300,280 L350,300 Z" fill="#616161"/><rect x="180" y="160" width="60" height="50" fill="#B71C1C"/><polygon points="170,160 250,160 210,130" fill="#FFD700"/></svg>`
        };

        const locations = [
            { name: "布达拉宫", coords: [29.6555, 91.1185], svg: svgs.potala, desc: "<b>布达拉宫</b><br>坐落在红山之巅，集行政、宗教、政治事务于一体。自公元七世纪起成为达赖喇嘛的冬宫，象征着西藏佛教和历代行政统治的中心。" },
            { name: "大昭寺", coords: [29.6532, 91.1320], svg: svgs.jokhang, desc: "<b>大昭寺</b><br>拉萨的“城市精神中心”。环大昭寺内中心的释迦牟尼佛殿一圈称为“囊廓”，环大昭寺外墙一圈称为“八廓”。" },
            { name: "八廓街", coords: [29.6528, 91.1335], svg: svgs.barkhor, desc: "<b>八廓街</b><br>围绕大昭寺而建的转经道，也是拉萨最繁华的商业中心，保留了古城的风貌。" },
            { name: "罗布林卡", coords: [29.6530, 91.0940], svg: svgs.norbulingka, desc: "<b>罗布林卡</b><br>高原园林，绿树掩映下的金色宫殿，历代达赖喇嘛的夏宫。" },
            { name: "色拉寺", coords: [29.6945, 91.1330], svg: svgs.sera, desc: "<b>色拉寺</b><br>格鲁派六大寺院之一。著名的“辩经”仪式每日在此进行，是僧人参悟佛法的重要方式。" },
            { name: "药王山", coords: [29.6540, 91.1160], svg: svgs.yaowang, desc: "<b>药王山</b><br>与布达拉宫咫尺相对，是拍摄布达拉宫日出最经典的角度。" },
            { name: "小昭寺", coords: [29.6580, 91.1325], svg: svgs.ramoche, desc: "<b>小昭寺</b><br>相传由文成公主奠基，寺内供有释迦牟尼八岁等身像。" },
            { name: "哲蚌寺", coords: [29.6750, 91.0460], svg: svgs.drepung, desc: "<b>哲蚌寺</b><br>藏传佛教最大的寺庙，意为“堆米寺”。雪顿节展佛仪式最为壮观。" },
            { name: "扎基寺", coords: [29.6720, 91.1400], svg: svgs.zaki, desc: "<b>扎基寺</b><br>全西藏唯一的财神庙，香火鼎盛，信徒多为求财而来。" },
            { name: "仓姑寺", coords: [29.6500, 91.1360], svg: svgs.canggu, desc: "<b>仓姑寺</b><br>拉萨城内唯一的尼姑寺庙，环境清幽，花草繁茂。" },
            { name: "木如寺", coords: [29.6540, 91.1350], svg: svgs.muru, desc: "<b>木如寺</b><br>闹市中的清净之地，现为西藏佛教协会印经院。" },
            { name: "帕崩岗", coords: [29.7030, 91.1120], svg: svgs.pabonka, desc: "<b>帕崩岗</b><br>意为“巨石上的宫殿”。相传松赞干布当年在此闭关，也是藏文的诞生地。" }
        ];

        locations.forEach(function (loc) {
            var marker = L.marker(loc.coords, { icon: handDrawnIcon }).addTo(map);
            marker.on('click', function () {
                const content = document.getElementById('content');
                content.style.opacity = 0;
                setTimeout(() => {
                    content.innerHTML = `
                        <div class="image-frame">${loc.svg}</div>
                        <h2>${loc.name}</h2><p>${loc.desc}</p>
                    `;
                    content.style.opacity = 1;
                }, 200);
                map.flyTo(loc.coords, 15, { animate: true, duration: 1.2 });
            });
        });
    </script>
</body>